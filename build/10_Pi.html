<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>無限級数の数値計算 · Julia言語 講義資料</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Julia言語 講義資料</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">はじめに</a></li><li><a class="tocitem" href="01_基本機能.html">基本機能</a></li><li><a class="tocitem" href="01_変数.html">変数: Variables</a></li><li><a class="tocitem" href="02_浮動小数点数.html">浮動小数点数</a></li><li><a class="tocitem" href="03_関数.html">関数: Functions</a></li><li><a class="tocitem" href="04_条件分岐.html">条件分岐</a></li><li><a class="tocitem" href="05_配列.html">配列: Array</a></li><li><a class="tocitem" href="06_ループ.html">ループ処理</a></li><li class="is-active"><a class="tocitem" href="10_Pi.html">無限級数の数値計算</a><ul class="internal"><li><a class="tocitem" href="#無限級数"><span>無限級数</span></a></li><li><a class="tocitem" href="#円周率-pi"><span>円周率 <code>pi</code></span></a></li><li><a class="tocitem" href="#Leibniz（ライプニッツ）の公式"><span>Leibniz（ライプニッツ）の公式</span></a></li><li><a class="tocitem" href="#Machin（マチン）の公式:-[MathWorld](https://mathworld.wolfram.com/MachinsFormula.html)"><span>Machin（マチン）の公式: MathWorld</span></a></li><li><a class="tocitem" href="#Appendex:-BigFloat型で円周率を表示する"><span>Appendex: <code>BigFloat</code>型で円周率を表示する</span></a></li></ul></li><li><a class="tocitem" href="11_NewtonsMethod.html">Newton法</a></li><li><a class="tocitem" href="12_LinearAlgebra.html">連立一次方程式の数値計算</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="10_Pi.html">無限級数の数値計算</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="10_Pi.html">無限級数の数値計算</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ioikawa/EC-julia/blob/master/src/10_Pi.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="無限級数の数値計算"><a class="docs-heading-anchor" href="#無限級数の数値計算">無限級数の数値計算</a><a id="無限級数の数値計算-1"></a><a class="docs-heading-anchor-permalink" href="#無限級数の数値計算" title="Permalink"></a></h1><h2 id="無限級数"><a class="docs-heading-anchor" href="#無限級数">無限級数</a><a id="無限級数-1"></a><a class="docs-heading-anchor-permalink" href="#無限級数" title="Permalink"></a></h2><p class="math-container">\[\{a_n\}\]</p><p>を実数列とする．級数</p><p class="math-container">\[  \sum_{k=1}^\infty a_n\]</p><p>はある実数 <span>$S$</span> に収束するとする．第 <span>$n$</span> 項までの部分和を</p><p class="math-container">\[  S_n := \sum_{k=1}^n a_n\]</p><p>とおくと，<span>$S = \lim_{n \to \infty} S_n$</span> と表されるので， （大きな）正の整数 <span>$n$</span> に対して <span>$S_n$</span> は <span>$S$</span> の近似値を与える．</p><h2 id="円周率-pi"><a class="docs-heading-anchor" href="#円周率-pi">円周率 <code>pi</code></a><a id="円周率-pi-1"></a><a class="docs-heading-anchor-permalink" href="#円周率-pi" title="Permalink"></a></h2><p>Juliaでは，円周率は数学定数として実装してある．</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; pi           # 遅延評価．実際に計算されるときに適切な形で実体化される．</code><code class="nohighlight hljs ansi" style="display:block;">π = 3.1415926535897...</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Float64(pi)    # `Float64` 型として実体化</code><code class="nohighlight hljs ansi" style="display:block;">3.141592653589793</code></pre><p>後者の16桁の値は一致しているので，この節では円周率の正確な値として参照してよい． 念のため，円周率を16桁まで書き出しておく．</p><pre><code class="nohighlight hljs"> 3.14159_26535_89793</code></pre><p>ここでは円周率を無限級数で表し，近似値の計算方法について述べる．</p><h2 id="Leibniz（ライプニッツ）の公式"><a class="docs-heading-anchor" href="#Leibniz（ライプニッツ）の公式">Leibniz（ライプニッツ）の公式</a><a id="Leibniz（ライプニッツ）の公式-1"></a><a class="docs-heading-anchor-permalink" href="#Leibniz（ライプニッツ）の公式" title="Permalink"></a></h2><p>以下の交代級数に関する公式</p><p class="math-container">\[ 1 - \dfrac{1}{3} + \dfrac{1}{5} - \dfrac{1}{7} + \cdots = \dfrac{\pi}{4}\]</p><p>をLeibnizの公式と呼ぶ．これは収束が遅いので，円周率の近似値計算には適さないが，試しに計算してみよう．</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; function leibniz(n)
          s = 0.0
          for i in 0:n
              s += (-1)^i/(2i+1)
          end
          return 4s
       end</code><code class="nohighlight hljs ansi" style="display:block;">leibniz (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; leibniz(120)</code><code class="nohighlight hljs ansi" style="display:block;">3.149856975293274</code></pre><p>120+1項まで計算してやっと3桁まで一致する程度であり，やはり非常に収束が遅い．</p><h2 id="Machin（マチン）の公式:-[MathWorld](https://mathworld.wolfram.com/MachinsFormula.html)"><a class="docs-heading-anchor" href="#Machin（マチン）の公式:-[MathWorld](https://mathworld.wolfram.com/MachinsFormula.html)">Machin（マチン）の公式: <a href="https://mathworld.wolfram.com/MachinsFormula.html">MathWorld</a></a><a id="Machin（マチン）の公式:-[MathWorld](https://mathworld.wolfram.com/MachinsFormula.html)-1"></a><a class="docs-heading-anchor-permalink" href="#Machin（マチン）の公式:-[MathWorld](https://mathworld.wolfram.com/MachinsFormula.html)" title="Permalink"></a></h2><p>Machinの公式</p><p class="math-container">\[   4\arctan \dfrac{1}{5} - \arctan \dfrac{1}{239} = \dfrac{\pi}{4}.\]</p><p>を用いた円周率の近似値計算は収束が速く，より実用的である． <span>$\arctan x$</span> の原点におけるTaylor展開</p><p class="math-container">\[ \arctan x = x - \dfrac{x^3}{3} + \dfrac{x^5}{5} - \dfrac{x^7}{7} + \cdots\]</p><p>は <span>$|x| \le 1$</span> で収束する． この級数に<span>$x=1/5, 1/239$</span>を代入すると，次の級数展開を得る．</p><p class="math-container">\[\pi = 16\sum_{i=0}^\infty \frac{(-1)^i}{2i+1} 5^{-(2i+1)}
  - 4\sum_{i=0}^\infty \frac{(-1)^i}{2i+1} 239^{-(2i+1)}\]</p><p>これを適当な項数で打ち切れば円周率の近似を与える．</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Machinの公式で円周率の近似値を計算するプログラムを自分で作成してみよう．</p><pre><code class="nohighlight hljs">  abs(近似値 -  Float64(pi)) &lt; 1e-15</code></pre><p>が <code>true</code> になれば <code>Float64</code>型に関しては限界近くまで近似できていると判断してください．</p></div></div><h2 id="Appendex:-BigFloat型で円周率を表示する"><a class="docs-heading-anchor" href="#Appendex:-BigFloat型で円周率を表示する">Appendex: <code>BigFloat</code>型で円周率を表示する</a><a id="Appendex:-BigFloat型で円周率を表示する-1"></a><a class="docs-heading-anchor-permalink" href="#Appendex:-BigFloat型で円周率を表示する" title="Permalink"></a></h2><p>任意精度の浮動小数点数を扱うものとして，Juliaでは <code>BigFloat</code> 型が用意してある． <code>BigFloat</code>型で <code>pi</code> を実体化すれば任意の桁数で 円周率を表示できる．</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; setprecision(2600)   # 精度を 2600 bits に設定．</code><code class="nohighlight hljs ansi" style="display:block;">2600</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; big(pi)</code><code class="nohighlight hljs ansi" style="display:block;">3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647093844609550582231725359408128481117450284102701938521105559644622948954930381964428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273724587006606315588174881520920962829254091715364367892590360011330530548820466521384146951941511609433057270365759591953092186117381932611793105118548074462379962749567351885752724891227938183011949129833673362440656643086021394946395224737190702179860943702770539217176293176752384674818467669405132000568127145263560827785771342757789609173637178721468440901224953430146549585371050792279689258923542019956112129021960864034418159813629774771309960518707211349999998372978049951056</code></pre><p>2600 bits は 10進数に換算すると，およそ782桁 (<span>$2600 \log_{10} 2 \approx 782.7$</span>) に相当する． 出力を5桁ごとに区切って整形すると次のようになる．</p><pre><code class="nohighlight hljs">3.
14159 26535 89793 23846 26433 83279 50288 41971 69399 37510   
58209 74944 59230 78164 06286 20899 86280 34825 34211 70679
82148 08651 32823 06647 09384 46095 50582 23172 53594 08128    
48111 74502 84102 70193 85211 05559 64462 29489 54930 38196 
44288 10975 66593 34461 28475 64823 37867 83165 27120 19091
45648 56692 34603 48610 45432 66482 13393 60726 02491 41273
72458 70066 06315 58817 48815 20920 96282 92540 91715 36436 
78925 90360 01133 05305 48820 46652 13841 46951 94151 16094 
33057 27036 57595 91953 09218 61173 81932 61179 31051 18548
07446 23799 62749 56735 18857 52724 89122 79381 83011 94912
98336 73362 44065 66430 86021 39494 63952 24737 19070 21798
60943 70277 05392 17176 29317 67523 84674 81846 76694 05132 
00056 81271 45263 56082 77857 71342 75778 96091 73637 17872 
14684 40901 22495 34301 46549 58537 10507 92279 68925 89235
42019 95611 21290 21960 86403 44181 59813 62977 47713 09960
51870 72113 49999 99837 29780 49951 056</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="06_ループ.html">« ループ処理</a><a class="docs-footer-nextpage" href="11_NewtonsMethod.html">Newton法 »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Sunday 17 April 2022 19:09">Sunday 17 April 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
